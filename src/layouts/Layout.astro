---
interface Props {
  title: string;
}

const { title } = Astro.props;

// Tạo page_id dựa trên đường dẫn của trang
const pathname = Astro.url.pathname;
// Loại bỏ base path "/portfolio" và trailing slash
let pageId = pathname.replace(/^\/portfolio\/?/, "") || "index";
// Thay thế các ký tự đặc biệt và tạo page_id
pageId = pageId
  .split("/")
  .filter(Boolean)
  .join(".");
pageId = `portfolio.${pageId}`;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="darkreader-lock" />
    <title>{title}</title>
  </head>
  <body>
    <div class="page-shell">
      <slot />
    </div>

    <footer class="footer">
      <div class="footer__inner">
        <p>Made with Astro · Catppuccin palette</p>
        <div class="footer__right">
          <img
            src={`https://visitor-badge.laobi.icu/badge?page_id=${pageId}`}
            alt="Visitor Badge"
            class="visitor-badge"
          />
          <div class="footer__dots" aria-hidden="true">
            <span class="dot dot--mauve"></span>
            <span class="dot dot--pink"></span>
            <span class="dot dot--peach"></span>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>

<style is:global>
  /* TODO: Adjust the color scheme if you want
     (recommendation: Catppuccin - https://catppuccin.com/palette/) */
  :root {
    /* Catppuccin Mocha */
    --ctp-rosewater: #f5e0dc;
    --ctp-flamingo: #f2cdcd;
    --ctp-pink: #f5c2e7;
    --ctp-mauve: #cba6f7;
    --ctp-red: #f38ba8;
    --ctp-maroon: #eba0ac;
    --ctp-peach: #fab387;
    --ctp-yellow: #f9e2af;
    --ctp-green: #a6e3a1;
    --ctp-teal: #94e2d5;
    --ctp-sky: #89dceb;
    --ctp-sapphire: #74c7ec;
    --ctp-blue: #89b4fa;
    --ctp-lavender: #b4befe;
    --ctp-text: #cdd6f4;
    --ctp-subtext1: #bac2de;
    --ctp-subtext0: #a6adc8;
    --ctp-overlay2: #9399b2;
    --ctp-overlay1: #7f849c;
    --ctp-overlay0: #6c7086;
    --ctp-surface2: #585b70;
    --ctp-surface1: #45475a;
    --ctp-surface0: #313244;
    --ctp-base: #1e1e2e;
    --ctp-mantle: #181825;
    --ctp-crust: #11111b;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    background-color: var(--ctp-base);
    color: var(--ctp-text);
    font-family:
      -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
      Cantarell, sans-serif;
    line-height: 1.6;
  }

  a {
    color: inherit;
  }

  .page-shell {
    min-height: 100vh;
  }

  .footer {
    margin-top: 3rem;
    border-top: 1px solid var(--ctp-surface1);
    background: rgba(17, 17, 27, 0.8);
  }

  .footer__inner {
    max-width: 1100px;
    margin: 0 auto;
    padding: 1.25rem 1.5rem 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    color: var(--ctp-subtext0);
  }

  .footer__right {
    display: inline-flex;
    align-items: center;
    gap: 1rem;
  }

  .footer__dots {
    display: inline-flex;
    gap: 0.4rem;
  }

  .visitor-badge {
    height: 20px;
    vertical-align: middle;
    opacity: 0.9;
    transition: opacity 0.2s ease;
  }

  .visitor-badge:hover {
    opacity: 1;
  }

  .dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
  }

  .dot--mauve {
    background: var(--ctp-mauve);
  }

  .dot--pink {
    background: var(--ctp-pink);
  }

  .dot--peach {
    background: var(--ctp-peach);
  }

  @media (max-width: 640px) {
    .footer__inner {
      padding: 0.9rem 1rem;
    }
  }
</style>
